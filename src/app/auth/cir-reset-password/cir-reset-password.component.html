<div class="reset-password-container">
  <div class="reset-password-card">
    <div class="reset-password-header">
      <h2>Reset Password</h2>
      <p *ngIf="!passwordReset">Enter your new password below.</p>
      <p *ngIf="passwordReset" class="success-message">Your password has been successfully reset!</p>
    </div>

    <div *ngIf="!passwordReset">
      <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()" class="reset-password-form">
        <div class="form-group">
          <label for="password">New Password *</label>
          <input
            type="password"
            id="password"
            formControlName="password"
            class="form-control"
            [class.is-invalid]="resetPasswordForm.get('password')?.invalid && resetPasswordForm.get('password')?.touched"
            placeholder="Enter new password">
          <div class="invalid-feedback" *ngIf="resetPasswordForm.get('password')?.invalid && resetPasswordForm.get('password')?.touched">
            <span *ngIf="resetPasswordForm.get('password')?.errors?.['required']">Password is required</span>
            <span *ngIf="resetPasswordForm.get('password')?.errors?.['minlength']">Password must be at least 6 characters</span>
          </div>
        </div>

        <div class="form-group">
          <label for="confirmPassword">Confirm New Password *</label>
          <input
            type="password"
            id="confirmPassword"
            formControlName="confirmPassword"
            class="form-control"
            [class.is-invalid]="resetPasswordForm.get('confirmPassword')?.invalid && resetPasswordForm.get('confirmPassword')?.touched"
            placeholder="Confirm new password">
          <div class="invalid-feedback" *ngIf="resetPasswordForm.get('confirmPassword')?.invalid && resetPasswordForm.get('confirmPassword')?.touched">
            <span *ngIf="resetPasswordForm.get('confirmPassword')?.errors?.['required']">Please confirm your password</span>
            <span *ngIf="resetPasswordForm.get('confirmPassword')?.errors?.['passwordMismatch']">Passwords do not match</span>
          </div>
        </div>

        <button
          type="submit"
          class="btn btn-primary btn-block"
          [disabled]="resetPasswordForm.invalid || loading || !token">
          <span *ngIf="!loading">Reset Password</span>
          <span *ngIf="loading">Resetting...</span>
        </button>
      </form>

      <div *ngIf="!token" class="token-error">
        <p class="error-message">Invalid or missing reset token. Please request a new password reset link.</p>
        <a routerLink="/cir-forgot-password" class="btn btn-secondary btn-block">Request New Reset Link</a>
      </div>
    </div>

    <div *ngIf="passwordReset" class="success-actions">
      <a routerLink="/cir-user-login" class="btn btn-primary btn-block">Go to Login</a>
    </div>

    <div class="back-to-login" *ngIf="!passwordReset">
      <a routerLink="/cir-user-login">‚Üê Back to Login</a>
    </div>
  </div>
</div>
